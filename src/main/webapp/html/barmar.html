<!DOCTYPE html>
<html>
    <head>
        <title>BarMar</title>
        <meta charset="utf-8" />
        
<script   src="https://code.jquery.com/jquery-2.2.3.min.js"   integrity="sha256-a23g1Nt4dtEYOj7bR+vTu7+T8VP13humZFBJNIYoEJo="   crossorigin="anonymous"></script>
        
    <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="http://openlayers.org/en/v3.15.1/css/ol.css" type="text/css">
    <!-- script src="http://openlayers.org/en/v3.15.1/build/ol.js"></script -->
    <script src="ol-debug.js"></script>
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.3.12/proj4.js"></script>
    
    <script>
        proj4.defs('EPSG:32633', '+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 +units=m +no_defs');
        var proj32633 = ol.proj.get('EPSG:32633');
        proj32633.setExtent([-2500000.0,3500000.0,3045984.0,9045984.0]);
    </script>
     
     
        <style type="text/css">
            html, body, #map {
                margin: 0;
                width: 100%;
                height: 100%;
            }

            #text {
                position: absolute;
                bottom: 1em;
                left: 1em;
                width: 512px;
                z-index: 20000;
                background-color: white;
                padding: 0 0.5em 0.5em 0.5em;
            }
            
            #barmar {
                position: absolute;
                top: 1em;
                right: 50em;
                width: 800px;
                z-index: 20001;
                background-color: white;
                padding: 0 0.5em 0.5em 0.5em;
            }
        </style>
        
        
             
    </head>
    <body>

    <script>
        var xmlhttp = new XMLHttpRequest();
        var url = "../barmar.json?grid=BarMar&species=Cod";
        var myArr = null;
        xmlhttp.onreadystatechange = function() {
            if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                myArr = JSON.parse(xmlhttp.responseText);
                console.log(myArr);
                var gridAdd = function( txt ) {
                    $("#grid").append( '<li><a href="#" data-value="' + txt + '">' + txt + '</a></li>' );
                };
                var grid = myArr['grid']
                console.log("grid:"+grid);
                for (var i=0; i< grid.length; i++) {
                    gridAdd(grid[i]);
                }
                
                var speciesAdd = function( txt ) {
                    $("#species").append( '<li><a href="#" data-value="' + txt + '">' + txt + '</a></li>' );
                };
                var species = myArr['species']
                console.log("species:"+species);
                for (var i=0; i< species.length; i++) {
                    speciesAdd(species[i]);
                }
                
                var speciesSubAdd = function( txt ) {
                    $("#speciesSubGroup").append( '<li><a href="#" data-value="' + txt + '">' + txt + '</a></li>' );
                };
                var speciesSubgroup = myArr['speciesSubgroup']
                console.log("speciesSubgroup:"+speciesSubgroup);
                for (var i=0; i< speciesSubgroup.length; i++) {
                    speciesSubAdd(speciesSubgroup[i]);
                }    
            }
        };
        xmlhttp.open("GET", url, true);
        xmlhttp.send();
    </script>

 <div id="barmar" >
    <label for="grid" style="float: left">Grid</label>
    <div class="dropdown" style="float: left">
      <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
        BarMar
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu" id="grid" aria-labelledby="dropdownMenu1">
      </ul>
    </div>
    
    <label for="species" style="float: left">Species</label>
    <div class="dropdown" style="float: left">
      <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
        Cod
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu" id="species" aria-labelledby="dropdownMenu1">
      </ul>
    </div> 
    <label for="subspecies" style="float: left">Sub Species</label>
    <div class="dropdown" style="float: left">
      <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
        Cod_survey_trawl
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu" id="speciesSubGroup" aria-labelledby="dropdownMenu1">
      </ul>
    </div>  
    <label for="depth" style="float: left">depth</label>
    <div class="dropdown" style="float: left">
      <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
        All depths
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
        <li><a href="#" data-value="BarMar">0-10</a></li>
        <li><a href="#" data-value="NorMar">Bottom 50</a></li>
        <li><a href="#" data-value="WMOsquares">all depths</a></li>
      </ul>
    </div>    
    <label for="period" style="float: left">period</label>
    <div class="dropdown" style="float: left">
      <button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
        all periods
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
        <li><a href="#" data-value="BarMar">February 2010</a></li>
        <li><a href="#" data-value="NorMar">all periods</a></li>
      </ul>   
    </div>      
</div>
    <script> 
    $(".dropdown-menu li a").click(function(){
        $(this).parents(".dropdown").find('.btn').html($(this).text() + ' <span class="caret"></span>');
        $(this).parents(".dropdown").find('.btn').val($(this).data('value'));
      });
    </script>    
    
    
    <div id="map" class="map"></div>      
    <script>
      var layers = [
        new ol.layer.Tile({
          source: new ol.source.TileWMS({
            url: 'http://opencache.statkart.no/gatekeeper/gk/gk.open',
            params: {
              'layers': 'barentswatch_grunnkart', 
              'VERSION':'1.1.1' 
            }
          })
        })
      ];

      var map = new ol.Map({
        controls: ol.control.defaults().extend([
          new ol.control.ScaleLine({
            units: ol.control.ScaleLineUnits.METRIC
          })
        ]),
        layers: layers,
        target: 'map',
        view: new ol.View({
          projection: 'EPSG:32633',
          center: [1088474,8089849],
          zoom:4
        })
      });
    </script> 
    

        <div id="text">
            <h1 id="title">Metadata</h1>

            <div id="docs">
                <p>The 0-group survey has been conducted annually in the Barents Sea since 1965 by the Institute of Marine Research, (IMR), Norway, and the Polar Research Institute of Marine Fisheries and Oceanography (PINRO), Russia. The data presented in the BarMar database covers the period 1980- 2012 (ongoing), and are sampled in August - October.</p>
            </div> 
        </div>   
    </body>
</html>